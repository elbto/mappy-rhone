import places from 'places.js';

const initAutocomplete = () => {

  const addressInput = document.querySelector('#geo-address');
  const latInput = document.querySelector('#geo-lat');
  const longInput = document.querySelector('#geo-long');

  const polygon = rhonePolygon.flat()

  const polygon_string = "4.3880744564659,46.219790380732,4.388291015925,46.247956431405,4.3920466116785,46.263026545141,4.4058135314858,46.296057806589,4.4218715520166,46.294954263085,4.4272337977412,46.302730717527,4.4397213287914,46.293184568466,4.4583704273073,46.296976724079,4.4765696377244,46.284237867232,4.488465816487,46.287994462282,4.5039940949336,46.267132463094,4.5372643385622,46.269911483268,4.5464477974735,46.27391839397,4.5480762222411,46.282864938182,4.5577956308141,46.294551640092,4.5698487572768,46.293352201901,4.5726687726239,46.277139335718,4.5865068000033,46.268694622582,4.6185580580588,46.264793895574,4.6220235259619,46.270079226484,4.6183224944202,46.282440402941,4.6314517777677,46.289015276562,4.6352614072065,46.299289507242,4.6546591822967,46.303484822155,4.6693820675804,46.297910092985,4.6794340760587,46.303994122044,4.6931098569714,46.302197476983,4.694515991108,46.292672565821,4.7075411259083,46.284660070276,4.7076872577415,46.269647917424,4.6878811178807,46.265311972919,4.6795502516132,46.258666565339,4.6883618181605,46.25011389523,4.7028290155173,46.251330439429,4.7357666167041,46.234244688808,4.7326605831699,46.227019799221,4.7206237625559,46.222390986056,4.7356928657613,46.211923783014,4.72266470068,46.202320489849,4.7243706747794,46.184304976244,4.7305257874621,46.178368585861,4.7597597705914,46.172840600415,4.7608053446831,46.175968780182,4.7802082627383,46.176676203678,4.7842423740016,46.168398418477,4.8023781362741,46.156887423266,4.7974397118441,46.140702262151,4.7721518838355,46.118071984418,4.7711001932505,46.110444027243,4.7503200135049,46.094147345645,4.7482215731583,46.083210841607,4.7553305070909,46.080178266249,4.7616829876026,46.06883528189,4.7551690115181,46.05749901174,4.7395251280198,46.047211663829,4.7456554596239,46.035244267196,4.7440006438304,46.018176939023,4.7486001387369,46.009662778088,4.7516684157566,45.981108689225,4.7546311649847,45.973618413908,4.7484568614429,45.962409970129,4.729097034294,45.949095813426,4.7361797864484,45.938458980345,4.754211604612,45.934832922052,4.7717568016091,45.939225276574,4.781303944214,45.934878026573,4.7885569134338,45.923963932223,4.8058607348054,45.921560609717,4.8107708680666,45.908896224362,4.810260610989,45.897565111704,4.8348142747029,45.908769920371,4.8480301401278,45.912976466425,4.8645060523469,45.904617380238,4.8738314226335,45.893675005333,4.8806970810747,45.897164902283,4.8838320029013,45.879991282684,4.909010250355,45.874107574527,4.9012146769683,45.860333149898,4.916118270017,45.845459412501,4.9214939050883,45.83268452568,4.918157197021,45.809867431045,4.9237976894917,45.803994890806,4.943768407874,45.80953114067,4.9630797552526,45.81097149163,4.9816090942072,45.805451195255,4.9993378554409,45.810073041206,5.0163667700796,45.805572507594,5.0367172235658,45.807850969043,5.051058929079,45.812167330171,5.0661170051758,45.809506527915,5.101068799884,45.813378958875,5.0893113585792,45.784275046022,5.0611720639467,45.791532339886,5.0595234976359,45.782545469588,5.0701066801383,45.765478936083,5.093096251464,45.766087895262,5.089379542274,45.74965948259,5.0945254918509,45.739450682898,5.1226621095427,45.737811043006,5.1339368816918,45.733254459565,5.1481741409716,45.718787127083,5.1592030475156,45.714572205586,5.1430567075695,45.70002864286,5.1310549291459,45.707712334796,5.1190903977565,45.699708184787,5.1048861162621,45.700378923523,5.1081345828339,45.688028491968,5.0942617281168,45.682878871985,5.0888320304231,45.67702542226,5.0773503823499,45.67469665728,5.0542255730691,45.660136259749,5.0580570584302,45.653246417357,5.044542399742,45.647272778433,5.0351462071679,45.637203894595,5.0436466037904,45.621332111414,5.0380861620656,45.615067173692,5.004740525885,45.62311302936,4.9894470341835,45.618525768193,5.0019895947765,45.61395165469,4.9979604182227,45.603410458278,4.9719782401764,45.612682039538,4.9603757463763,45.610073577685,4.936077557335,45.608840645632,4.9275304060187,45.605707819264,4.9014588479373,45.60626328191,4.8927769429114,45.601555646906,4.8821976306935,45.601571961358,4.8729020897275,45.595302229166,4.8597792137897,45.590828133064,4.8577266463597,45.5795777754,4.810043763556,45.589552751649,4.8034791539416,45.587537956161,4.7771292183341,45.587395458322,4.7820837628775,45.580581569271,4.8086931363098,45.572300631782,4.8311024088019,45.547770728452,4.8401221979115,45.543293629833,4.8644436168106,45.537346005002,4.8728116747039,45.531305267791,4.8684816431075,45.523437511407,4.841259965977,45.500603648061,4.8272424509878,45.49628139378,4.8120086150016,45.483343833967,4.7822796715264,45.472208128185,4.7794738263144,45.45503324486,4.7569316195483,45.455703808946,4.7399125598478,45.472150707566,4.7433101731851,45.474764896895,4.7394098424085,45.486593747758,4.7223405808585,45.494295691224,4.7002191965255,45.478249654895,4.6819265003418,45.479805150655,4.6617482375007,45.486752644296,4.6551392825647,45.486304493343,4.6506024356174,45.49710900433,4.6543426246071,45.499750539461,4.6494323830973,45.51712905461,4.650497265707,45.528252850314,4.6613903387752,45.536037070395,4.674488312844,45.550479461372,4.6837344760466,45.55253624936,4.6873997607785,45.558523925089,4.6831387073324,45.565644636168,4.6699440512117,45.570285378667,4.6585848075301,45.56377146269,4.6492789007153,45.56490904439,4.6478824204468,45.556792876108,4.6589149161667,45.542658451096,4.6447024494625,45.540521160907,4.636944001114,45.545633161464,4.6251877380181,45.569055361339,4.614861970331,45.575470989539,4.6028640886661,45.570404449666,4.5877499129831,45.570573911416,4.5686010114212,45.583468098473,4.5528567342845,45.578486287879,4.5428213574395,45.579838520111,4.5197664342597,45.573253603438,4.5047759790565,45.576543545812,4.5051531322954,45.581744190937,4.4838595815624,45.58624940097,4.4679838181681,45.586688341581,4.4744464613895,45.594709488515,4.454234347968,45.604183406335,4.4404819320115,45.623477104497,4.4102790829383,45.632049970336,4.3926780038356,45.653703042225,4.3916724723063,45.662900921407,4.3659250305716,45.67124520038,4.3666896828173,45.685045108392,4.3732834826114,45.691495316239,4.3655162451168,45.698520895445,4.384861183026,45.721388505488,4.3930262500122,45.73962196206,4.402874533303,45.744322736901,4.3912519410447,45.754931122336,4.3648245203449,45.749517040539,4.3502759881234,45.765572799369,4.3493594526122,45.771303606196,4.3591428768023,45.780984046301,4.3758660518349,45.78207558241,4.3779742385557,45.790373451489,4.3736933831237,45.805064418906,4.3884958699132,45.806032530629,4.3762210046271,45.824638493705,4.3835765208093,45.826844321257,4.3906037050232,45.837471017303,4.3833781565992,45.847457660114,4.39318791688,45.85490602736,4.3937657765842,45.865177816896,4.3830283320289,45.863990304997,4.3573105997855,45.867819950961,4.3421582115897,45.877180049661,4.3383805732565,45.886651647406,4.3239325275487,45.900497659693,4.3454237850592,45.915370885136,4.3380440076381,45.921621376175,4.3437483577496,45.931115680498,4.3225089205335,45.940414442089,4.3068244792521,45.945360003465,4.2939148881952,45.953401305103,4.3008529759177,45.957960852692,4.2980954426863,45.965658535725,4.288248100938,45.973613541516,4.2751720909979,45.979779420897,4.2534923621873,45.983659900377,4.2480467270692,45.986721755059,4.243469905983,45.997155157363,4.2762354842316,45.993440504556,4.291857109907,45.995195243694,4.3005636506591,45.991309437399,4.3125045374594,46.005590580996,4.3069346878253,46.012302407533,4.3060931313608,46.021227299478,4.2931321166524,46.020034909779,4.2779133191973,46.022570733364,4.2621612945195,46.035394464095,4.25428598242,46.052728453285,4.2804122607347,46.052946216253,4.2970729797104,46.063367890941,4.3109599658762,46.079190537296,4.309496394554,46.110310117939,4.3209316069531,46.121673075435,4.3215705432747,46.129223594176,4.3349408525378,46.135557948536,4.3426667635704,46.134431163894,4.3615871317803,46.138458636435,4.3703360612818,46.147436195393,4.3802731178293,46.150002449909,4.4107792053657,46.136621688891,4.421942123828,46.142446470167,4.4264818352348,46.152802675294,4.433065036007,46.157315762201,4.4385869916472,46.16787797859,4.4161119485317,46.179768496894,4.406360379933,46.182287943556,4.3959933191533,46.189137102955,4.3962361504561,46.195567283506,4.422617863137,46.202554255239,4.4218122058978,46.208599447092,4.4085006257224,46.217963185953,4.3880744564659,46.219790380732"
  console.log(polygon_string)

  if (addressInput) {
    const autocomplete = places({
                                  language: 'fr',
                                  container: addressInput,
                                  countries: ['fr'],
                                  aroundLatLng: [45.8802348, 4.5645336] ,
                                  aroundRadius: 50000
                               });

    autocomplete.on('change', (e) => {
      const event = new CustomEvent('latlngChange', { detail: { lat: e.suggestion.latlng.lat, long: e.suggestion.latlng.lng }});
      addressInput.dispatchEvent(event);

      if (latInput)
        latInput.value = e.suggestion.latlng.lat
      if (longInput)
        longInput.value = e.suggestion.latlng.lng
    })
  }
};

export { initAutocomplete };
