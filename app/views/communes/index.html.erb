<%
  legends = [
    {
      color: '#05361A',
      label: 'Un peu au dessus du budget',
      description: 'Frère, il va falloir négocier'
    },
    {
      color: '#096A32',
      label: 'Dans le budget',
      description: 'C\'est bueno, tu peux y aller gros !'
    },
    {
      color: '#5B8A73',
      label: 'En dessous du budget',
      description: 'C\'est cheap mon gars, fonce !'
    }
  ]
%>


<main>
  <div class="criteres">
    <div>
      <h1 class="text-center m-4">Mappy Rhône</h1>
      <div class="hero-image">
      <div class="search-form container card" style="width:400px" data-controller="geocoder">
        <div class="card-body from-group p-4">
          <%= form_with url: communes_path, method: :get do |f| %>
           <div class="label my-3">
              <%= f.label :address, 'Où est ton bar préféré ?', class: "p-2" %>
              <%= f.text_field :address,
                                placeholder: 'Trouve une adresse',
                                value: params[:address],
                                id: 'geo-address',
                                class:"form-control p-3" %>
           </div>
           <div class="label my-3">
              <%= f.label :price, 'Quel budget veux-tu mettre ?', class: "p-2" %>
              <%= f.text_field :price_query, class:"form-control " %>
           </div>
           <div class="label my-3">
              <%= f.label :km, 'Combien de km es-tu prêt à parcourir ?', class: "p-2" %>
              <%= f.range_field :km, in: 0..20 ,class:"form-range p-3", min:"0", max:"50", step:"2" %>
           </div>
            <%= f.submit "Search", class:"btn btn-primary w-100 mt-4" %>
          <% end %>
        </div>
      </div>
    </div>

    <div class="search-form container card mt-4" style="width:400px">
      <div class="legend" style="padding: 1em; display: grid;  grid-template-columns: 60px auto;
    align-items: center;    row-gap: 12px;">

          <% legends.each do |legend| %>
            <div style="background: <%= legend[:color] %>; width: 40px; height: 20px; "></div>
            <div>
              <p style="padding: 0; margin: 0; font-weight: bold;"><%= legend[:label] %></p>
              <p style="padding: 0; margin: 0; font-size: 0.8em;
    color: #5c5c5c;"><%= legend[:description] %></p>
            </div>
          <% end %>
        </div>
      </div>
    </div>

    </div>
  </div>
  <div class="mapbox-section">
    <div class="mapbox" id="map"
      style="width: 100%; height: 100vh;"
      data-controller="box"
      data-box-target="mapContainer"
      data-box-price-query-value="<%= params[:price_query] %>"
      data-box-distance-value="<%= params[:km] %>"
      data-box-address-value="<%= params[:address] %>">
    </div>
  </div>
</main>
